<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/js-jws/3.2.0/jws.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.20/jsrsasign-all-min.js"></script>
	</head>
<body>
    <script type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'

			embeddedservice_bootstrap.init(
				'00Dak00000XwTZn',
				'Web',
				'https://gerentllc-d-dev-ed.develop.my.site.com/ESWWeb1757243067568',
				{
					scrt2URL: 'https://gerentllc-d-dev-ed.develop.my.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};

	async function generateJWT() {
            // Check if the jws library is loaded
            if (typeof jws === 'undefined') {
                console.error('Error: jws library is not loaded. Check your network connection or the script URL.');
                throw new Error('jws library not found.');
            }

            // Placeholder values. Replace with your actual connected app and user data.
            // Example of a correctly formatted private key.
            const privateKey = `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCjPd0yyi1/4pqV
d+x/hlxb7+uuupMaVVeXrhQQf6nTKQ8KNDdD3DcTMd90p3pX333biOWHdUmTMI6D
3EyL9dDDRdcbj474CF3jomWzj3nwuyVwalFA91KgYfR2+gFovTJEkE1VpHxcOXJr
I7h4GIifJ1ShfC8xrsnF02Q85jSxnmAO+lwgsPhDb+4LIsPi0Zst9AvvJp5faQUt
LX4YZ0f9rtxyTIwwBt2fmfvNhZqHmBKi9jpRrQkB/A0NJQ3kaio+lNYbyzPCzETS
E7UUNr1qX6OK6WAHRXsIltTE8fZ5iUsoO4BFuE4kdXy7qvhguLouEHBhIhcIISYG
we3nIod9AgMBAAECggEABARIpP4K7qRBU90jvpW1dyfP/DPsuDZpKhsga8OmtF4N
zri4RUQE41chyRPenwz74qUyYPMVjSH0RhG0nOjjXTIi2jOUyYz9J0yqEugOtS6b
++hThrm/OLO2DfuNE/fgrvNJnZN5mJ19r5S2ZWlCj6Ozgai6W9hIpzuJH/6jIO/W
o10mxRPIry1I6ZjjXjlR+nroCqwiMZrIv8KKX/kKwki5AM3zu1PHiiTgdM5Qd0fn
lVPRwfxu5QZEssnr8/+q0gHC/qG+3Z0vLDMKp0Q+j2oQhSsvdTLAldFonMEwKtfr
PSi3e23vBkHUTyLuH/d/9pxRcdMi/KRLTCV+2oYOoQKBgQDgr/iT04B4l//Fo4kK
ql5RkgFRTu/qyUzTHRhUMA1Jo85LmXapGsIXYhOedfTamRqiXTofPXEqLDm+V1fY
sj0GnrQj4SCriDqQkNq0TzRyuLvBh0HVJ+jxk/PM+ZJ20XRbQsMbyQFpW6NtIvdn
Qp60v2g1GnxKeLxQOF4lYgTUoQKBgQC5/buZiUjTPvjVEw77dqZt6M0P88uuM719
q+N/ye4kt3OPxWmwJfbA1/p2XIR0XP0VRbXmqn/Sm1A+rcQExeygAVNI1LpigLeN
5rxUNKd4Ktejyv5l2fWA4K8BH6wSz9/bQJUTSsi/u0moEyZVxHZYTfBBVMNviMc3
4JOlaSOpXQKBgQDQHw+w1itdCOZZCobpAzBEfGqOBwFCSF3J+1xKtwvH11xCOI9q
SifYgvdLQ1WfmkvKc3Jf94i4GKkP/1WWmlreo+iWh3S8jn445IRAmlEppqX7uC6p
o8Mo6fPdPJuHRbJyyh9xwDl3fvOdJtNlqZbaM6Xx8muIi9dasyu5ktaIoQKBgChW
tcd5FQhsEf/0oD094J7Z7Q/WqohfxGtrSm4+152zBCdcg62mrjvpG/Nr4XZzbJie
g/NBa3O8J81QVsFKRCX3455aNQqELEtkjdgdi2zurdJihoaEnVCUaqBtxB5YY47k
FPEYOS4Mas8/SAM2FwzT6pXg0npwSfT+ikdH5GopAoGAOlDhw05nldv5J8aM1Z3l
FragQZ22nLC0MYzqcuvlDqofwkjgRXxaoEs8ixE1iy2Hxx3cKzKoegjI5aaC0G52
yyPgSY3FYA5+peZcOfkWhy5od0fKNVm85kC4FqKmWg8mL/Ap5ChjlI2Vqr5cFnGV
iuhqYxcfiD3ydo+6uF5BBPM=
-----END PRIVATE KEY-----`;

            const header = {
                "alg": "RS256"
            };

            const payload = {
                "iss": "3MVG9JJwBBbcN47JhZxXJ8aqK9oicqIfdbFWPeZj2IHpyfgPXEHCcjwISJW8w0ZHi7DLofdrAHDbcgIc85Lb5",
                "sub": "srinivas.nemala@gerent.com.jwtauth", // The Salesforce user this token is for
                "aud": "https://login.salesforce.com",
                "exp": Math.floor(Date.now() / 1000) + 360 // Expiration time (360 seconds from now)
            };

            const jwt = jws.sign({ header: header, payload: payload, privateKey: privateKey });
            console.log("Generated Mock JWT: ", jwt);

            return jwt;
	}
	window.addEventListener("onEmbeddedMessagingReady", async () => {
	  console.log("Received the onEmbeddedMessagingReady event.");
	  const jwtToken = await generateJWT();
	  embeddedservice_bootstrap.userVerificationAPI.setIdentityToken({
	    identityTokenType: "JWT",
	    identityToken: jwtToken,
	  });
	});

</script>
<script type='text/javascript' src='https://gerentllc-d-dev-ed.develop.my.site.com/ESWWeb1757243067568/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>

</body>
</html>
